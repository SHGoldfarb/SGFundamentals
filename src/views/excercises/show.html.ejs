<p>
  <ul class="unstyled in-line tags">
    <% excercise.tags.forEach (tag => { %>
      <li class="in-line">
        <%= tag.name %>
        <% if (isAdmin) { %>
          <form action="<%= buildTagDeletePath(tag.id) %>" method="post">
            <input type="hidden" name="_method" value="delete" />
            <input type="hidden" name="returnPath" value="<%= returnPath %>" />
            <button class="close-icon" type="submit">X</button>
          </form>
        <% } %>
      </li>
    <% }) %>
  </ul>
  <h2><%= excercise.title %></h2>
  <br />
  <div class="row nowrap start">
    <%- include("../votes/_voting", { votes: excercise.votes, resource: 'excercise', id: excercise.id }) %>
    <%= excercise.content %>
  </div>
  <div style="font-size: 14px">
    <br />
    By <a href="<%= buildUserPath(excercise.user.id) %>"><%= excercise.user.username %></a>
    <% if (isOwnerOrAdmin) { %>
      <a href="<%= editExcercisePath %>">Editar</a>
    <% } %>
  </div>
</p>

<% if (isAdmin) { %>
  <form action="<%= createTagPath %>" method="post">
    <input type="hidden" name="excerciseId" value="<%= excercise.id %>" />
    <input type="hidden" name="returnPath" value="<%= returnPath %>" />
    <div>
      <label for="name">Nuevo Tag:</label>
      <input name="name" id="name" />
      <input type="submit" name="answer" value="Crear Tag" />
    </div>
  </form>
<% } %>

<% if (currentUser) { %>
  <form action="<%= createCommentPath %>" method="post">
    <input type="hidden" name="excerciseId" value="<%= excercise.id %>" />
    <input type="hidden" name="userId" value="<%= currentUser.id %>" />
    <input type="hidden" name="returnPath" value="<%= returnPath %>" />
    <div>
      <label for="content">Tu respuesta:</label>
      <textarea name="content" id="content"></textarea>
    </div>
    <div>
      <input type="submit" name="answer" value="Responder" />
    </div>
  </form>
<% } %>

<% comments.forEach (comment => { %>
  <div class="comment-box">
    <div class="in-line">
      <div class="comment-content" style="margin-right: 20px">
        <div class="row nowrap start">
          <%- include("../votes/_voting", { votes: comment.votes, resource: 'comment', id: comment.id }) %>
          <%= comment.content %>
        </div>
        <div class="in-line" style="margin-top: 10px; font-size: 14px">
          By:&nbsp <a href="<%= buildUserPath(comment.user.id) %>"><%= comment.user.username %></a>
          &nbsp <%= comment.createdAt %>
          <% if (isAdmin || isOwner(comment.user.id)) { %>
            <a href="<%= buildCommentEditPath(comment.id) %>">Editar</a>
            <form action="<%= buildCommentDeletePath(comment.id) %>" method="post">
              <input type="hidden" name="_method" value="delete" />
              <input type="hidden" name="returnPath" value="<%= returnPath %>" />
              <button class="delete-button" type="submit">Eliminar</button>
            </form>
          <% } %>
        </div>
      </div>
      <% if (currentUser) { %>
        <form action="<%= createCommentPath %>" method="post">
          <input type="hidden" name="commentId" value="<%= comment.id %>" />
          <input type="hidden" name="userId" value="<%= currentUser.id %>" />
          <input type="hidden" name="returnPath" value="<%= returnPath %>" />
          <div>
            <label for="content">Tu respuesta:</label>
            <div>
              <textarea name="content" id="content"></textarea>

            </div>
          </div>
          <div>
            <input type="submit" name="answer" value="Responder" />
          </div>
        </form>
      <% } %>
    </div>
    <% if (comment.child.length > 0) { %>
      <% comment.child.forEach (comment2 => { %>
        <div class="subcomment-box" style="margin-left: 50px">
          <div class="row nowrap start">
            <%- include("../votes/_voting", { votes: comment2.votes, resource: 'comment', id: comment2.id }) %>
            <%= comment2.content %>
          </div>
          
          <div class="in-line" style="margin-top: 10px; font-size: 14px">
            By:&nbsp <a href="<%= buildUserPath(comment2.user.id) %>"><%= comment2.user.username %></a>
            &nbsp <%= comment2.createdAt %>
            <% if (isAdmin || isOwner(comment2.user.id)) { %>
              <a href="<%= buildCommentEditPath(comment2.id) %>">Editar</a>
              <form action="<%= buildCommentDeletePath(comment2.id) %>" method="post">
                <input type="hidden" name="_method" value="delete" />
                <input type="hidden" name="returnPath" value="<%= returnPath %>" />
                <button class="delete-button" type="submit">Eliminar</button>
              </form>
            <% } %>
          </div>
        </div>
      <% }) %>
    <% } %>
  </div>
<% }) %>



<!-- <h1></h1>
<a href="<%= backToListPath %>">Volver</a>
<% if (excercise.guideId) { %>
  <a href="<%= backToGuidePath %>">Ir a guia</a>
<% } %>
<h1>Ejercicio #<%= excercise.id %></h1>

<p>
    <%= excercise.content %>
</p>

<ul>
  <% if (isOwnerOrAdmin) { %>
    <li><a href="<%= editExcercisePath %>">Editar</a></li>
    <li>
      <form action="<%= deleteExcercisePath %>" method="post">
        <input type="hidden" name="_method" value="delete" />
        <div>
          <input type="submit" name="delete" value="Eliminar" />
        </div>
      </form>
    </li>
  <% } %>
</ul>

<% if (isAdmin) { %>
  <form action="<%= createTagPath %>" method="post">
    <input type="hidden" name="excerciseId" value="<%= excercise.id %>" />
    <input type="hidden" name="returnPath" value="<%= returnPath %>" />
    <div>
      <label for="name">Nuevo Tag:</label>
      <textarea name="name" id="name"></textarea>
      <input type="submit" name="answer" value="Crear Tag" />
    </div>
  </form>
<% } %>

<% if (tags.length > 0) { %>
  Tags:
  <ul>
    <% tags.forEach(tag => { %>
      <li class="in-line">
        <%= '  ' + tag.name %>
        <% if (isAdmin) { %>
          <span style="display: inline">
            <form action="<%= buildTagDeletePath(tag.id) %>" method="post">
              <input type="hidden" name="_method" value="delete" />
              <input type="hidden" name="returnPath" value="<%= returnPath %>" />
              <div>
                <input type="submit" name="delete" value="Eliminar" />
              </div>
            </form>
          </span>
        <% } %>
        <br />
      </li>
    <% }) %>
  </ul>
<% } %>


<% if (currentUser) { %>
  <form action="<%= createCommentPath %>" method="post">
    <input type="hidden" name="excerciseId" value="<%= excercise.id %>" />
    <input type="hidden" name="userId" value="<%= currentUser.id %>" />
    <input type="hidden" name="returnPath" value="<%= returnPath %>" />
    <div>
      <label for="content">Tu respuesta:</label>
      <textarea name="content" id="content"></textarea>
    </div>
    <div>
      <input type="submit" name="answer" value="Responder" />
    </div>
  </form>
<% } %>

<% if (comments.length > 0) { %>
  Respuestas:
  <ul>
    <% comments.forEach(comment => { %>
      <li class="in-line">
        <a href="<%= buildCommentPath(comment.id) %>">#<%= comment.id %>-</a>
        <%=  comment.user.username + ' => ' + comment.content %>
        <% if (isOwner(comment.user.id) || isAdmin) { %>
          <form action="<%= buildCommentDeletePath(comment.id) %>" method="post">
            <input type="hidden" name="_method" value="delete" />
            <input type="hidden" name="returnPath" value="<%= returnPath %>" />
            <div>
              <input type="submit" name="delete" value="Eliminar" />
            </div>
          </form>
        <% } %>
        <br />
      </li>
    <% }) %>
  </ul>
<% } %> -->
