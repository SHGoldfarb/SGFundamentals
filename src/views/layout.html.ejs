<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <title>SG Fundamentals</title>
    <% if (env !== 'development') { %>
      <link rel="stylesheet" href="/assets/styles.css">
    <% } %>
    <link href='https://fonts.googleapis.com/css?family=Allerta' rel='stylesheet'>
  </head>

  <body>

    <div class="nav">
      <div class="nav-section">
        <a class="nav-link <%= currentUrl == "/" ? "active" : "" %>"
          href="/">Inicio
        </a>
        <a class="nav-link <%= currentUrl.substr(0,excercisesPath.length) == excercisesPath ? "active" : "" %>"
          href="<%= excercisesPath %>">Ejercicios
        </a>
        <a class="nav-link <%= currentUrl.substr(0,questionsPath.length) == questionsPath ? "active" : "" %>"
          href="<%= questionsPath %>">Preguntas
        </a>
        <a class="nav-link <%= currentUrl.substr(0,filesPath.length) == filesPath ? "active" : "" %>"
          href="<%= filesPath %>">Archivos
        </a>
        <a class="nav-link <%= currentUrl.substr(0,guidesPath.length) == guidesPath ? "active" : "" %>"
          href="<%= guidesPath %>">Guias
        </a>
        <% if (isAdmin) { %>
          <a class="nav-link <%= currentUrl.substr(0,commentsPath.length) == commentsPath ? "active" : "" %>"
            href="<%= commentsPath %>">Comentarios
          </a>
          <a class="nav-link <%= currentUrl.substr(0,usersPath.length) == usersPath ? "active" : "" %>"
            href="<%= usersPath %>">Usuarios
          </a>
          <% } %>
      </div>
      <div class="nav-section">
        <% if(currentUser){ %>
          <p class="nav-text"> Hola <%= currentUser.username %></p>
          <form action="<%= signOutPath %>" method="post">
            <input type="hidden" name="_method" value="delete">
            <button type="submit" class="nav-link">Logout</button>
          </form>
        <% }else{ %>
        <a class="nav-link <%= currentUrl.substr(0,signInPath.length) == signInPath ? "active" : "" %>" href="<%= signInPath %>">Sign In</a>
        <a class="nav-link <%= currentUrl.substr(0,signUpPath.length) == signUpPath ? "active" : "" %>" href="<%= signUpPath %>">Sign Up</a>
        <% } %>
      </div>
    </div>
    <% if (locals.error) { %>
      <div class="error hideable" id="error_message">
          <p>(!!) <%= error %></p>
          <p id="close">X</p>
      </div>
    <% } %>
    <div class="wrapper">
    <%- body %>
    </div>
    <div class="footer">
      <h1>Footer</h1>
    </div>
    <script src="/assets/app.js"></script>
    <script>

    // Needs moving to separate js file

    function tagFilterFunction() {
      // taken from https://www.w3schools.com/howto/howto_js_filter_lists.asp
      // Declare variables
      let i;
      const input = document.getElementById('tagFilterInput');
      const filter = input.value.toUpperCase();
      const ul = document.getElementById('tagFilterUL');
      const li = ul.getElementsByTagName('li');

      // Loop through all list items, and hide those who don't match the search query
      for (i = 0; i < li.length; i += 1) {
        const a = li[i].getElementsByTagName('a')[0];
        if (a.innerHTML.toUpperCase().indexOf(filter) > -1) {
          li[i].style.display = '';
        } else {
          li[i].style.display = 'none';
        }
      }
    }
    </script>
  </body>

</html>
